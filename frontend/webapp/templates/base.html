<!--  Application: Anerkennung AI Cockpit -->
<!--  Module: templates/base.html -->
<!--  Version: 0.1.0 (Refined Navbar + Auth Logic + Sticky Nav) -->

<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>

  <title>{% block title %}Anerkennung-AI-Cockpit{% endblock %}</title>

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" 
        rel="stylesheet"
        crossorigin="anonymous">

  <!-- Bootstrap Icons -->
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"
        crossorigin="anonymous">

  <link rel="icon" href="{{ url_for('static', filename='img/favicon.ico') }}"/>

  <style>
      :root {
          --brand-text: #1f2937;
          --brand-primary: #1f6fd6;
          --brand-secondary: #334155;
          --brand-accent: #0f9fa8;
          --brand-hover: #175bb3;
      }
      body { --bs-body-color: var(--brand-text); }

      /* Make space for fixed navbar */
      body {
          padding-top: 4.5rem;
      }

      .btn {
          border-radius: 0.5rem;
          font-weight: 600;
      }
      .btn-primary,
      .btn-success {
          background-color: var(--brand-primary);
          border-color: var(--brand-primary);
          color: #fff;
      }
      .btn-secondary,
      .btn-dark {
          background-color: var(--brand-secondary);
          border-color: var(--brand-secondary);
          color: #fff;
      }
      .btn-info,
      .btn-warning,
      .btn-danger {
          background-color: var(--brand-accent);
          border-color: var(--brand-accent);
          color: #fff;
      }
      .btn:hover {
          background-color: var(--brand-hover) !important;
          border-color: var(--brand-hover) !important;
          color: #fff !important;
      }
      .btn-outline-primary,
      .btn-outline-secondary,
      .btn-outline-info,
      .btn-outline-danger {
          border-width: 2px;
      }
      .btn-outline-primary {
          color: var(--brand-primary);
          border-color: var(--brand-primary);
      }
      .btn-outline-secondary {
          color: var(--brand-secondary);
          border-color: var(--brand-secondary);
      }
      .btn-outline-info,
      .btn-outline-danger {
          color: var(--brand-accent);
          border-color: var(--brand-accent);
      }
      .btn-outline-primary:hover,
      .btn-outline-secondary:hover,
      .btn-outline-info:hover,
      .btn-outline-danger:hover {
          color: #fff;
          background-color: currentColor;
          border-color: currentColor;
      }
      .dashboard-buttons .btn {
          background-color: var(--brand-primary) !important;
          border-color: var(--brand-primary) !important;
          color: #fff !important;
      }
      .dashboard-buttons .btn:hover {
          filter: none;
          color: #fff !important;
      }
      .dashboard-buttons .btn {
          text-align: left;
      }
      .badge {
          border-radius: 999px;
          font-weight: 600;
          text-transform: capitalize;
      }
      .bg-success,
      .bg-primary {
          background-color: var(--brand-primary) !important;
      }
      .bg-warning,
      .bg-info {
          background-color: var(--brand-accent) !important;
          color: #fff !important;
      }
      .bg-danger,
      .bg-secondary {
          background-color: var(--brand-secondary) !important;
          color: #fff !important;
      }
      .dm-scroll {
          max-height: 70vh;
          overflow-y: auto;
      }
      .doc-badges {
          min-width: 120px;
          display: flex;
          flex-direction: column;
          align-items: flex-end;
          gap: 0.25rem;
      }
      .doc-actions {
          display: flex;
          flex-direction: column;
          gap: 0.35rem;
          min-width: 110px;
      }
      .btn,
      .badge {
          white-space: nowrap;
      }
      .field-ready {
          background-color: #e7f2ff;
          border-color: #9fc5f8;
      }
      .field-missing {
          background-color: #ffffff;
          border-color: #f0b8b8;
      }
  </style>

  {% block head_extra %}{% endblock %}
</head>

<body class="bg-light d-flex flex-column min-vh-100">

<!-- ========================================================= -->
<!-- NAVBAR (sticky at top) -->
<!-- ========================================================= -->
<nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top shadow-sm">
    <div class="container">
        <a class="navbar-brand d-flex align-items-center gap-2" 
           href="{{ url_for('main.index') }}">
            <img src="{{ url_for('static', filename='img/favicon.ico') }}" height="28" alt="Logo">
            <span class="fw-semibold">Anerkennung-AI-Cockpit</span>
        </a>

        <button class="navbar-toggler" type="button"
                data-bs-toggle="collapse" 
                data-bs-target="#navbarNav"
                aria-controls="navbarNav"
                aria-expanded="false"
                aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarNav">

            <!-- Left Menu Items -->
            {% if current_user.is_authenticated %}
              <li class="nav-item">
                <a class="nav-link text-light" href="{{ url_for('main.dashboard') }}">
                  <i class="bi bi-speedometer2 me-1"></i> Dashboard
                </a>
              </li>
            {% else %}
              <ul class="navbar-nav me-auto">
                  <li class="nav-item"><a class="nav-link" href="#how">How it works</a></li>
                  <li class="nav-item"><a class="nav-link" href="#recruiters">Recruiters</a></li>
                  <li class="nav-item"><a class="nav-link" href="#faq">FAQ</a></li>
              </ul>
            {% endif %}

            <!-- Right Side Auth -->
            <ul class="navbar-nav ms-auto">

                {% if current_user.is_authenticated %}
                    <!-- User Dropdown -->
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle d-flex align-items-center"
                           href="#"
                           id="userDropdown"
                           role="button"
                           data-bs-toggle="dropdown"
                           aria-expanded="false">
                            <i class="bi bi-person-circle me-2"></i>
                            {{ current_user.username or "User" }}
                        </a>

                        <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userDropdown">
                            <li>
                                <form action="{{ url_for('auth.logout') }}" method="post" class="px-3 py-1">
                                    {% if csrf_token is defined %}
                                      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                                    {% endif %}
                                    <button class="btn btn-sm btn-outline-danger w-100" type="submit">
                                        <i class="bi bi-box-arrow-right me-1"></i> Logout
                                    </button>
                                </form>
                            </li>
                        </ul>
                    </li>

                {% else %}
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('auth.login') }}">
                            <i class="bi bi-box-arrow-in-right me-1"></i> Login
                        </a>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('auth.register') }}">
                            <i class="bi bi-person-plus me-1"></i> Register
                        </a>
                    </li>

                    <li class="nav-item d-flex align-items-center ms-3 text-light">
                        <i class="bi bi-person-circle me-1"></i> Guest
                    </li>
                {% endif %}
            </ul>

        </div>
    </div>
</nav>

<!-- ========================================================= -->
<!-- FLASH MESSAGES -->
<!-- ========================================================= -->
<div class="container mt-3">
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      {% for category, message in messages %}
        <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
          {{ message }}
          <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
      {% endfor %}
    {% endif %}
  {% endwith %}
</div>

<!-- ========================================================= -->
<!-- MAIN CONTENT -->
<!-- ========================================================= -->
<main id="content" class="flex-grow-1">
    {% block content %}{% endblock %}
</main>

<!-- ========================================================= -->
<!-- FOOTER -->
<!-- ========================================================= -->
<footer class="border-top mt-5 py-4 bg-white">
  <div class="container d-flex flex-column flex-md-row gap-3 justify-content-between align-items-start">
    <div>
      <div class="fw-semibold">Anerkennung-AI-Cockpit</div>
      <small class="text-muted">&copy; {{ 2025 }} â€” All rights reserved.</small>
    </div>
    <ul class="nav flex-column flex-md-row gap-3">
      <li class="nav-item"><a class="nav-link p-0 text-body-secondary" href="/impressum">Impressum</a></li>
      <li class="nav-item"><a class="nav-link p-0 text-body-secondary" href="/privacy">Datenschutz</a></li>
      <li class="nav-item"><a class="nav-link p-0 text-body-secondary" href="/contact">Kontakt</a></li>
    </ul>
  </div>
</footer>

<!-- ========================================================= -->
<!-- SCRIPTS -->
<!-- ========================================================= -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" 
        crossorigin="anonymous"></script>

<script src="{{ url_for('static', filename='js/app.js') }}"></script>

{% block body_scripts %}{% endblock %}

</body>
</html>
